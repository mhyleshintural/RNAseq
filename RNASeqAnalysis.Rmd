---
title: "RNAseqAnalysis"
author: "Mhyles Hintural"
date: "26/08/2020"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Set-up

```{r}
library(plyr)
library(reshape2)
library(dplyr)
library(tidyverse)
library(magrittr)
library(edgeR)
library(RColorBrewer)
library(limma)
library(ggplot2)
library(readxl)
library(pheatmap)
library(here)
library(xtable)
library(biomaRt)
library(org.Hs.eg.db)
library(factoextra)
```

# Data packaging
## Importing count data

```{r ImportCounts}
 
# Read in bam counts
termPlacentaCounts <- read.table(here("rawData/bam_counts.table.tsv"),
                                 sep = '\t',
                                 header = TRUE,
                                 row.names = "Geneid")
 
# clean up the column headers and remove the file extension names
names(termPlacentaCounts) <- gsub("_Aligned.sortedByCoord.out.bam", "", names(termPlacentaCounts))
 
 
names <- names(termPlacentaCounts) %>%
  as.data.frame() %>%
  separate(., col = ., into = c("cohort", "samplenumber", "tissue", "lane"), sep = "_") %>%
  mutate(., samplename = paste(cohort, samplenumber, sep = "")) %>%
  dplyr::select(., samplename)
 
# convert back to a vector so I can overwrite the colnames in the counts table
names <- names[,]
 
# replace the old sample names with the new names
names(termPlacentaCounts) <- names
```

## Importing meta-data

```{r ImportMetadata}

# Read in metadata

simpleMetadata <- read_excel(here("cleanData/simpleMetadata_matched.xlsx"))

# this seemed to work, I didn't think I had to do the rest of the steps as there were no file extension names
```